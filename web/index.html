<html>
<head>
    <title>金小泽健身房欢迎您</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
    <meta charset="UTF-8"/>
    <!--引入 jq-->
    <script src="static/jquery/jquery-3.3.1.min.js"></script>
    <link href="static/css/index.css" rel="stylesheet"/>
</head>
<script type="text/javascript">
    //加载公告
    $(document).ready(function () {
        start();
        $.ajax({
            url: "/announcement/getAnnListAll",
            type: "GET",
            success(data) {
                //成功回调函数
                console.log(data);
                examine();
            },
            error(xhr, status, error) {
                //出错回调函数
                console.log("连接超时，请刷新当前页面");
            }
        })
    });
    //公告移动
    var timer = null;

    function start() {
        $("#div1").mouseover(function () {
            startMove(0);
        });
        $("#div1").mouseout(function () {
            startMove(-150);
        });
    };

    function startMove(iTarget) {
        clearInterval(timer);
        timer = setInterval(function () {
            var iSpeed = 0;
            if ($("#div1").offset().left < iTarget) {
                iSpeed = 10;
            } else {
                iSpeed = -10;
            }
            ;
            if ($("#div1").offset().left == iTarget) {
                clearInterval(timer);
            } else {
                $("#div1").css("left", $("#div1").offset().left + iSpeed + 'px');
            }
        }, 30)
    };
    //检查用户是否登录
    //默认未登录
    var code = 0;
    function examine() {
        $.ajax({
            url: "/user/examineLogin",
            type: "GET",
            success(data) {
                if (data == 0) {
                    console.log("用户未登录：" + data);
                    $("#aText").text("未登录");
                    $("#loginText").attr("href", "clientView/userLogin.html");
                    code = data;
                } else if (data == 1) {
                    console.log("用户已登录：" + data);
                    $("#aText").text("已登录");
                    $("#loginText").text("退出登录");
                    code = data;
                } else {
                    console.log("登录超时");
                }
            },
            error(xhr, status, error) {
                console.log("连接超时");
            }
        })
    };
    //退出登录
    $(document).ready(function () {
        $("#loginText").click(function () {
            $.ajax({
                url: "/user/userQuit",
                type: "GET",
                success(data) {
                    if (data == 0) {
                        console.log("用户不存在，请前往登录");
                        location.href = "clientView/userLogin.html";
                    } else {
                        console.log("用户成功退出");
                        location.href = "/index.html";
                    }
                },
                error(xhr, status, error) {
                    console.log("用户连接超时");
                }
            })
        })
    });
    //点击预约
    $(document).ready(function () {
        $("#course").click(function () {
            //检查是否登录
            examine();
            if (code == 0) {
                console.log("请先登录再预约!");
                location.href = "clientView/userLogin.html";
            } else {
                console.log("正在进入预约界面!");
                location.href = "clientView/courseList.html";
            }
        })
    })
</script>

<body>
<div class="home-head">
    <div id="head">
        <table>
            <tr>
                <!--logo-->
                <td width="400"></td>
                <td align="right">
                    <ul>
                        <li><a href="index.html" class="menu-home">首页</a></li>
                        <li><a href="" id="loginText" class="menu-feat">会员登录</a></li>
                        <li><a id="course">会员预约</a></li>
                        <li><a href="#" id="aText" class="reg"></a></li>
                    </ul>
                </td>
            </tr>
        </table>
    </div>
    <!--侧边栏广告-->
    <div id="div1" class="cb">
        <span class="cb">健身公告</span>
    </div>
    <!--end-->
    <div class="home-prd">
        <img src="static/img/prd.png"/>
        <div class="home-prd-intro">
            <div class="subtit">金小泽健身房，欢迎您的到来</div>
        </div>
    </div>
</div>
<div id="foot">
    <div class="main">
        <div class="contact">
            <table>
                <tr>
                    <th>
                        <div class="cs-contact">
                            <div id="yourCs">
                                <img src="static/img/wx.jpg"/>
                            </div>
                            <div class="cs-tit">金小泽健身房公众号</div>
                        </div>
                    </th>
                    <td>
                        <ul>
                            <li><label>公司地址：</label>广东省广州市白云区太和镇兴太三路638号</li>
                            <li><label>联系电话：</label>0000 - 0000 0000</li>
                            <li><label>咨询时间：</label>9:00 ~ 22:00 <span class="gray">（周一至周日）</span></li>
                            <li><label>咨询QQ：</label>1234567890 <span class="gray">（更多详情，尽情畅聊）</span></li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

</body>
</html>
